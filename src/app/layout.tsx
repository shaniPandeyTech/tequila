'use client'

import React, { useState, useEffect, useRef } from 'react'
import type { Metadata } from 'next'
import Link from 'next/link'
import './globals.css'

import { motion, AnimatePresence } from 'framer-motion'
import LenisProvider from '@/component/SmoothScrollProvider'
import Header from '@/component/Header'
import Footer from '@/component/Footer'

// export const metadata: Metadata = {
//   title: 'Tequila',
//   description: 'An Award Winning Branding and Web Design Agency in Dubai.'
// }

export default function RootLayout({
  children
}: Readonly<{
  children: React.ReactNode
}>) {
  const [showNavbar, setShowNavbar] = useState(false)
  const [isOpen, setIsOpen] = useState(false)

  useEffect(() => {
    const handleScroll = () => {
      const shouldShow = window.scrollY > window.innerHeight
      setShowNavbar(shouldShow)
    }

    window.addEventListener('scroll', handleScroll)
    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  const handleToggle = () => setIsOpen((prev) => !prev)

  const menuItems = [
    'Home',
    'Case Studies',
    'What We Do',
    'The Agency',
    'Insights',
    'FAQ',
    'Contact'
  ]

  return (
    <html lang="en">
      <body suppressHydrationWarning>
        <Link href={'/'} className="fixed bottom-12 right-12">
          <svg viewBox="0 0 99 101" fill="none" className="w-[100px]">
            <path
              d="M9.92225 81.2718L14.4653 75.1875L14.4306 75.1435L7.5538 78.2721L6.85107 77.3821L15.1702 73.6855L16.0465 74.7953L11.6561 80.5985L11.6908 80.6425L18.3802 77.751L19.2478 78.8498L13.7222 86.0845L12.9934 85.1615L17.5839 79.1824L17.5492 79.1385L10.625 82.1618L9.92225 81.2718Z"
              fill="white"
            />
            <path
              d="M18.2969 84.4273C19.9446 82.2683 22.521 81.8922 24.5577 83.4465C26.6055 85.0093 26.9115 87.5852 25.2638 89.7443C23.6161 91.9033 21.0507 92.2879 19.003 90.7251C16.9663 89.1708 16.6491 86.5864 18.2969 84.4273ZM19.2985 85.1918C17.9905 86.9057 18.1179 88.7464 19.6315 89.9015C21.1451 91.0566 22.9653 90.7023 24.2733 88.9883C25.5813 87.2744 25.4428 85.4252 23.9292 84.2701C22.4156 83.115 20.6065 83.4778 19.2985 85.1918Z"
              fill="white"
            />
            <path
              d="M30.8108 97.3566L29.222 89.2116L26.4177 95.3493L25.3862 94.8781L29.0517 86.8558L29.9303 87.2572L31.6469 95.83L34.5909 89.3867L35.6223 89.8579L31.9569 97.8802L30.8108 97.3566Z"
              fill="white"
            />
            <path
              d="M38.7654 90.9309L40.2165 91.1658L43.1408 95.8797L44.3152 95.0204L44.8186 91.9108L46.0209 92.1055L44.6114 100.812L43.4091 100.617L44.1049 96.3194L39.194 99.9351L37.7705 99.7047L42.1355 96.4828L38.7654 90.9309Z"
              fill="white"
            />
            <path
              d="M53.5571 100.9L52.3395 100.93L52.1468 93.12L47.2343 93.2412L47.2095 92.2335L53.3396 92.0823L53.5571 100.9Z"
              fill="white"
            />
            <path
              d="M61.1419 99.5419L59.8441 99.833L54.335 92.0294L55.5917 91.7476L57.1967 94.042L61.1173 93.1627L61.5615 90.4088L62.7226 90.1484L61.1419 99.5419ZM60.274 98.3592L60.9599 94.188L57.7906 94.8988L60.2194 98.3714L60.274 98.3592Z"
              fill="white"
            />
            <path
              d="M65.1416 89.1195L66.2437 88.6346L69.3895 95.7853L72.324 94.4943L72.7299 95.4169L65.7075 98.5063L65.3015 97.5837L68.2874 96.2701L65.1416 89.1195Z"
              fill="white"
            />
            <path
              d="M79.4937 83.8375L78.6719 84.5601C77.6329 83.3282 76.2527 83.3499 75.0778 84.2565C74.036 85.0605 73.7241 86.0085 74.3143 86.7733C74.8104 87.4161 75.471 87.4014 76.5167 86.8774L78.1075 86.0743C79.2922 85.4784 80.4292 85.4852 81.2674 86.5714C82.2082 87.7906 81.8854 89.366 80.3558 90.5463C78.6046 91.8977 76.8776 91.745 75.652 90.1796L76.4934 89.4596C77.4161 90.5867 78.619 90.7018 79.7717 89.8123C80.7803 89.0339 80.9778 88.1211 80.3791 87.3453C79.8488 86.6581 79.2233 86.7871 78.2945 87.2563L76.8428 87.9875C75.38 88.7272 74.3095 88.6691 73.4457 87.5497C72.4535 86.2639 72.9889 84.666 74.4962 83.5029C76.2142 82.1772 78.1937 82.1528 79.4937 83.8375Z"
              fill="white"
            />
            <path
              d="M84.2613 85.3161L85.1953 86.2629L84.2086 87.2363L83.2844 86.2994C82.5962 85.6017 82.3922 85.036 83.1896 84.2297L83.6714 84.718C83.3222 85.1215 83.3603 85.3396 83.7929 85.7782L84.2613 85.3161Z"
              fill="white"
            />
            <path
              d="M81.6343 76.7425L82.3784 75.796L88.5198 80.6242L90.5012 78.1038L91.2936 78.7268L86.552 84.7581L85.7596 84.1351L87.7757 81.5707L81.6343 76.7425Z"
              fill="white"
            />
            <path
              d="M85.6746 73.0433L84.7773 72.5839L87.6419 66.9885L95.4928 71.0078L92.6857 76.491L91.7885 76.0317L94.0597 71.5952L91.5922 70.332L89.7868 73.8588L88.902 73.4058L90.7074 69.8791L88.0032 68.4947L85.6746 73.0433Z"
              fill="white"
            />
            <path
              d="M98.3454 62.5721L97.9939 63.7383L90.5144 61.4834L89.0959 66.1882L88.1309 65.8972L89.9008 60.0262L98.3454 62.5721Z"
              fill="white"
            />
            <path
              d="M87.3357 18.2697L83.1336 24.5943L83.1706 24.6363L89.8653 21.1348L90.6158 21.9849L82.5122 26.1327L81.5763 25.0727L85.6414 19.0371L85.6044 18.9952L79.0838 22.2496L78.1572 21.2001L83.2772 13.6729L84.0555 14.5545L79.8003 20.7766L79.8374 20.8186L86.5851 17.4196L87.3357 18.2697Z"
              fill="white"
            />
            <path
              d="M78.8003 15.5789C77.2738 17.8253 74.722 18.3426 72.6029 16.9027C70.4722 15.4549 70.0249 12.8998 71.5514 10.6533C73.0778 8.40687 75.6181 7.88177 77.7487 9.32953C79.8678 10.7694 80.3267 13.3324 78.8003 15.5789ZM77.7581 14.8707C78.9698 13.0875 78.7413 11.2565 77.1665 10.1864C75.5917 9.11635 73.7937 9.57034 72.582 11.3536C71.3702 13.1369 71.6103 14.9757 73.1852 16.0458C74.76 17.1159 76.5464 16.654 77.7581 14.8707Z"
              fill="white"
            />
            <path
              d="M65.5986 3.35641L67.6296 11.4025L70.0948 5.12088L71.1504 5.53515L67.9283 13.7455L67.0291 13.3927L64.8471 4.9264L62.2592 11.5208L61.2036 11.1065L64.4257 2.89612L65.5986 3.35641Z"
              fill="white"
            />
            <path
              d="M58.006 10.2059L56.5441 10.0512L53.3649 5.50533L52.2395 6.42801L51.908 9.56052L50.6968 9.43233L51.625 0.661316L52.8363 0.789501L52.378 5.11932L57.0825 1.23889L58.5165 1.39065L54.3355 4.84782L58.006 10.2059Z"
              fill="white"
            />
            <path
              d="M42.6909 1.06379L43.9051 0.967224L44.5244 8.75464L49.423 8.36505L49.5029 9.36988L43.3902 9.85603L42.6909 1.06379Z"
              fill="white"
            />
            <path
              d="M35.1914 2.83494L36.4713 2.47321L42.3999 9.96311L41.1604 10.3134L39.4321 8.11043L35.5656 9.20324L35.2731 11.9774L34.1279 12.301L35.1914 2.83494ZM36.1228 3.96835L35.6666 8.17085L38.7922 7.28746L36.1767 3.95312L36.1228 3.96835Z"
              fill="white"
            />
            <path
              d="M31.7704 13.4637L30.6972 14.0096L27.1554 7.0466L24.2978 8.50014L23.8408 7.6017L30.679 4.12335L31.136 5.0218L28.2285 6.50073L31.7704 13.4637Z"
              fill="white"
            />
            <path
              d="M17.7247 19.518L18.5061 18.752C19.6103 19.9258 20.9873 19.8294 22.1114 18.8605C23.1082 18.0013 23.3683 17.0379 22.7376 16.3062C22.2074 15.6911 21.5485 15.7415 20.5327 16.3213L18.9878 17.2094C17.8371 17.8686 16.7014 17.9233 15.8056 16.8841C14.8002 15.7176 15.0372 14.127 16.5007 12.8657C18.1762 11.4215 19.909 11.4805 21.2175 12.9772L20.4163 13.7417C19.4339 12.6663 18.2265 12.6164 17.1237 13.567C16.1587 14.3988 16.0109 15.321 16.6507 16.0633C17.2174 16.7207 17.835 16.5581 18.7371 16.0393L20.1471 15.2306C21.5677 14.4128 22.6397 14.4128 23.5629 15.4839C24.6232 16.714 24.1751 18.3385 22.7329 19.5816C21.0892 20.9984 19.114 21.1298 17.7247 19.518Z"
              fill="white"
            />
            <path
              d="M12.8764 18.3137L11.8906 17.4209L12.8211 16.3936L13.7965 17.2771C14.5228 17.935 14.7583 18.4883 14.0074 19.3382L13.499 18.8776C13.825 18.4551 13.7747 18.2396 13.3181 17.826L12.8764 18.3137Z"
              fill="white"
            />
            <path
              d="M15.9742 26.7223L15.2824 27.7077L8.8889 23.2187L7.04664 25.8425L6.22168 25.2633L10.6302 18.9844L11.4552 19.5637L9.58075 22.2333L15.9742 26.7223Z"
              fill="white"
            />
            <path
              d="M12.1394 30.6369L13.0605 31.0462L10.5077 36.7905L2.44775 33.2086L4.94941 27.5795L5.87055 27.9888L3.84648 32.5433L6.37959 33.6691L7.98862 30.0485L8.89696 30.4522L7.28793 34.0727L10.0641 35.3065L12.1394 30.6369Z"
              fill="white"
            />
            <path
              d="M0.0688477 41.8036L0.354115 40.6194L7.94883 42.4491L9.09974 37.6718L10.0797 37.9078L8.64353 43.8693L0.0688477 41.8036Z"
              fill="white"
            />
            <foreignObject x="-15.8" y="-14.8" width="131.6" height="131.6">
              <div
                style={{
                  backdropFilter: 'blur(16px)',
                  clipPath: 'url(#bgblur_clip_path)',
                  height: '100%',
                  width: '100%'
                }}
              ></div>
            </foreignObject>
            <g data-figma-bg-blur-radius="31.8">
              <circle cx="50" cy="51" r="34" fill="white" fillOpacity="0.12" />
              <circle cx="50" cy="51" r="33.5" stroke="white" strokeOpacity="0.21" />
            </g>
            <path
              d="M40.8464 67.1882C43.643 68.7107 46.7948 69.5091 50 69.5091C60.4748 69.5091 69 61.094 69 50.7546C69 40.4151 60.4748 32 50 32C39.5252 32 31 40.4151 31 50.7546C31 54.0757 31.8863 57.3268 33.5772 60.1873L31.1592 70L40.8464 67.1882ZM41.8553 41.9907C42.2576 41.6255 42.7804 41.4302 43.3268 41.4302H43.9055C44.6714 41.4302 45.3533 41.9037 45.6136 42.6108L46.7968 45.83C46.9065 46.1337 46.8528 46.4713 46.6484 46.7261L45.7126 47.8792C45.3426 48.3294 45.2436 48.9452 45.4587 49.4824C46.5925 52.2981 49.9635 54.2772 51.7254 55.1479C52.3644 55.4622 53.1302 55.3433 53.6358 54.8485L54.6705 53.8271C54.9179 53.5829 55.288 53.4958 55.6236 53.5978L58.7623 54.5873C59.5174 54.8273 60.0294 55.5174 60.0294 56.2988V57.0866C60.0294 57.6621 59.797 58.2163 59.384 58.624C56.327 61.6033 51.2542 59.4182 47.9675 57.4285C45.5989 55.993 43.5337 54.1074 41.9976 51.8184C38.2802 46.2801 40.5388 43.1758 41.8553 41.9907Z"
              fill="white"
            />
            <defs>
              <clipPath id="bgblur_clip_path" transform="translate(15.8 14.8)">
                <circle cx="50" cy="51" r="34" />
              </clipPath>
            </defs>
          </svg>
        </Link>

        <AnimatePresence>
          {showNavbar && (
            <motion.div
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: 30 }}
              transition={{ duration: 0.4, ease: 'easeInOut' }}
              className="navbar-wrapper"
            >
              {/* Main Nav */}
              <div className="navbar">
                <ul>
                  {menuItems.map((item) => (
                    <li key={item}>
                      <a
                        href="#"
                        className="tq__FoundersGrotesk_14"
                        onClick={
                          item === 'What We Do'
                            ? (e) => {
                                e.preventDefault()
                                handleToggle()
                              }
                            : undefined
                        }
                      >
                        {item}
                      </a>
                    </li>
                  ))}
                </ul>
              </div>

              {/* Sub Nav */}
              <AnimatePresence>
                {isOpen && (
                  <motion.div
                    initial={{ clipPath: 'inset(100% 0% 0% 0%)', opacity: 0 }}
                    animate={{ clipPath: 'inset(0% 0% 0% 0%)', opacity: 1 }}
                    exit={{ clipPath: 'inset(100% 0% 0% 0%)', opacity: 0 }}
                    transition={{ duration: 0.5, ease: 'easeInOut' }}
                    className="navbar-open overflow-hidden"
                  >
                    <ul>
                      <li>
                        <a className="tq__Instrument_16 uppercase">Web Design & Development</a>
                      </li>
                      <li>
                        <a className="tq__Instrument_16 uppercase">Branding</a>
                      </li>
                      <li>
                        <a className="tq__Instrument_16 uppercase">Communication</a>
                      </li>
                    </ul>
                    <h3 className="tq__Instrument_22">
                      “We are there for <br />
                      any and every one <br />
                      of your needs!”
                    </h3>
                  </motion.div>
                )}
              </AnimatePresence>
            </motion.div>
          )}
        </AnimatePresence>

        <LenisProvider>
          <Header />
          {children}
          <Footer />
        </LenisProvider>
      </body>
    </html>
  )
}
